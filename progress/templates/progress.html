{% extends "base.html" %}
{% load staticfiles %}
{% block title %} Progress {% endblock %}

{% block extrahead %} {%endblock%}

{% block content %}

<div class="container">
    <div class="row">

        <div class="col"></div>

        <div class="col-md-6 col-sm-12">


            <div class="jumbotron">
                <center>
                    <h1 class="display-4"> Сегодня {{ current_date }} </h1>

                    <hr class="my-4">

                    {%if user.is_authenticated %}
                    Привет, {{user.username}} <a href="/progress/login">Выйти </a><br/>

                    {%endif%}
                    <br>

                    <a href='add_target'> Добавить новую цель </a>


                </center>
            </div>
        </div>
        <div class="col"></div>
    </div>
</div>

<!--Начало цикла по целям-->

{% for task in qs %}

<div class="container">
    <div class="row">

        <div class="col"></div>

        <div class="col-md-6 col-sm-12">


            <div class="jumbotron">
                <center>
                    <h1 class="display-4"> {{ task.target_description }}: {{task.target}} </h1>
                    <p class="lead"> к {{task.end_date}}</p>
                    <p class="lead"> ежедневно {{task.daily|floatformat:'1'}}</p>
                    <p class="lead">

                         {% if task.end_date < current_date and task.done < task.target %}

                    <div class="alert alert-danger" role="alert">
                        Задача просрочена
                    </div>
                    {%endif%}

                    {% if task.done >= task.target %}

                    <div class="alert alert-success" role="alert">
                        Цель достинута! В зал славы?(сделать)
                    </div>
                    {%endif%}



                    Редактировать: <a class='' href='/progress/edit_target/{{task.id}}'>
                        <img
                        src="{% static 'progress/edit.png' %}"
                        alt="edit target"/> </a>
                    Удалить: <a class='' href='/progress/delete_target/{{task.id}}'>
                        <img
                        src="{% static 'progress/trash.png' %}"
                        alt="delete target"/> </a>

                    <hr class="my-4">



 <form id='form{{task.id}}' action="" method="post" style="display:none;">
        {% csrf_token %}

        <input name="id" type="hidden" value="{{task.id}}">
        <input name="new_progress" type="number" size="4" value="{{task.done}}"> <br>
        <input type="submit" value="Сохранить" form="form{{task.id}}">

</form>

                    <!-- скрипт для кнопок -->
                    <script>
$(document).ready(function(){
    $("#hide{{task.id}}").click(function(){
        $("#form{{task.id}}").hide();
    });
    $("#show{{task.id}}").click(function(){
        $("#form{{task.id}}").show();
    });
});

                    </script>
                    <!-- конец скрипта для кнопок -->

                    <button id="show{{task.id}}">+</button>
                    сделано: {{task.done}} <br>
                    {{task.word}}: разница в днях {{task.f1|floatformat:'1'}}

                    {% if task.target <= 0 %}
                    <div class="alert alert-warning" role="alert">
                        Нулевая цель выглядит странно
                    </div>
                    {%endif%}


                    <div class="progress">

                        {%if task.f1 < 0 %}

                        <div class="progress-bar progress-bar-striped bg-warning" role="progressbar"
                             style="width: {{task.f2}}%;"
                             aria-valuenow="{{task.f2}}"
                             aria-valuemin="0" aria-valuemax="100">
                            {{task.f2}}%
                            <br>
                        </div>
                        {%else%}
                        <div class="progress-bar progress-bar-striped bg-success" role="progressbar"
                             style="width:{{task.f2}}%"
                             aria-valuenow="{{task.f2}}"
                             aria-valuemin="0" aria-valuemax="100">

                             {{task.f2}}%
                            <br>
                        </div>
                        {% endif%}

                    </div>

                    <div class="progress progress_tobe" >


                        <div class="progress-bar" role="progressbar"
                             style="width: {{task.todo_today}}%;"
                             aria-valuenow="{{task.todo_today}}"
                             aria-valuemin="0" aria-valuemax="100">

                            <br>
                        </div>


                    </div>


                </center>
            </div>
        </div>
        <div class="col"></div>
    </div>
</div>



{% endfor %}

<!--Конец цикла по целям -->

{% endblock %}

